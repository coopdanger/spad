<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Simple Port and Address Discovery</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
   
	  a {
	  text-decoration: none;
	  }
       
      a.info {
           
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
           
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
   
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Example"/>
<link href="#rfc.section.4" rel="Chapter" title="4 RAML"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Schemas"/>
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Consideration"/>
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations"/>
<link href="#rfc.section.8" rel="Chapter" title="8 Acknowledgments"/>
<link href="#rfc.references" rel="Chapter" title="9 References"/>
<link href="#rfc.references.1" rel="Chapter" title="9.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="9.2 Informative References"/>
<link href="#rfc.appendix.A" rel="Chapter" title="A Contributing"/>
<link href="#rfc.appendix.B" rel="Chapter" title="B Published Versions"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.0 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Jennings, C." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-jennings-dispatch-spad-v0-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2016-11-9" />
  <meta name="dct.abstract" content="This specification defines a simple JSON format and well known URL for firewalls and other devices to discover whats IP addresses, ports, and related transports a given cloud services uses.  " />
  <meta name="description" content="This specification defines a simple JSON format and well known URL for firewalls and other devices to discover whats IP addresses, ports, and related transports a given cloud services uses.  " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">Network Working Group</td>
  <td class="right">C. Jennings</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">Cisco</td>
</tr>
<tr>
  <td class="left">Intended status: Standards Track</td>
  <td class="right">November 9, 2016</td>
</tr>
<tr>
  <td class="left">Expires: May 13, 2017</td>
  <td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Simple Port and Address Discovery<br />
  <span class="filename">draft-jennings-dispatch-spad-v0-latest</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This specification defines a simple JSON format and well known URL for firewalls and other devices to discover whats IP addresses, ports, and related transports a given cloud services uses.  </p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on May 13, 2017.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2016 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<li>2.   <a href="#rfc.section.2">Terminology</a></li>
<li>3.   <a href="#rfc.section.3">Example</a></li>
<li>4.   <a href="#rfc.section.4">RAML</a></li>
<li>5.   <a href="#rfc.section.5">Schemas</a></li>
<li>6.   <a href="#rfc.section.6">IANA Consideration</a></li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a></li>
<li>8.   <a href="#rfc.section.8">Acknowledgments</a></li>
<li>9.   <a href="#rfc.references">References</a></li>
<ul><li>9.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>9.2.   <a href="#rfc.references.2">Informative References</a></li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Contributing</a></li>
<li>Appendix B.   <a href="#rfc.appendix.B">Published Versions</a></li>
<li><a href="#rfc.authors">Author's Address</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a></h1>
<p id="rfc.section.1.p.1">Simple Port and Address Discovery (SPAD) allows an web application to inform others of what ports and IP addresses it uses so that things like firewalls can correctly re-configure themsleves as the ports and addresses change. Applications are identified by a domain name which is used to form a URL in a well known location where a client can do a HTTP REST call to get a JSON file that describes information about what addresses and transport the service uses.  </p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#terminology" id="terminology">Terminology</a></h1>
<p id="rfc.section.2.p.1">In this document, the key words "MUST", "MUST NOT", "SHOULD", "SHOULD NOT", "MAY", and "OPTIONAL" are to be interpreted as described in RFC 2119 <a href="#RFC2119">[RFC2119]</a> and indicate requirement levels for compliant implementations.  </p>
<p id="rfc.section.2.p.2">RAML is defined at <span>&lt;</span><a href="https://github.com/raml-org">https://github.com/raml-org</a><span>&gt;</span>.  </p>
<p id="rfc.section.2.p.3">JSON Schema is defined at <span>&lt;</span><a href="http://json-schema.org/">http://json-schema.org/</a><span>&gt;</span>. Further information is available in <a href="#I-D.wright-json-schema">[I-D.wright-json-schema]</a>.  </p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#example" id="example">Example</a></h1>
<p id="rfc.section.3.p.1">To figure out what IP addresses are used by the service example.com, the first step is to form the query URL by constructing and point at ".well-known/spad/v0/transports".  </p>
<pre>
curl https://example.com/.well-known/spad/v0/transports
</pre>
<p id="rfc.section.3.p.2">An HTTPS GET query is done that to that URL. The responses would be a JSON result that could looks like </p>
<pre>
{
  "ver": 1,
  "transports": [
    {
      "ips": [
        "203.0.113.2"
      ],
      "ports": [
        443
      ]
    }
  ]
}
</pre>
<p id="rfc.section.3.p.3">The return result indicates that the "example.com" service uses only the IP address "203.0.113.2".  </p>
<p id="rfc.section.3.p.4">The following shows a more complex example result for an applications that uses only HTTP and QUIC over a small set of IP addresses. All traffic will be connecting to example.com or api.example.com from the point of view of TLS and proxies.  </p>
<pre>
{
  "ver": 1,
  "transports": [
    {
      "ips": [
        "192.0.2.1",
        "203.0.113.2",
        "2001:db8::1"
      ],
      "ports": [
        443
      ],
      "dns": [
        "example.com",
        "api.example.com"
      ],
      "protcols": [
        "https",
        "quic"
      ]
    }
  ]
}
</pre>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#raml" id="raml">RAML</a></h1>
<p id="rfc.section.4.p.1">The RAML specification for the API is: </p>
<pre>
#%RAML 0.8
title: SPAD
version: v0
protocols: [ HTTPS ]
baseUri: https://example.com/.well-known/spad/{version}
mediaType: application/json

schemas:
 - spad.json: !include spad-schema.json

documentation:
 - title: Overview
   content: !include overview.md
   
/transports:
  description: Transports used by this service 
  get:
    description: Retrieve the spad 
    responses:
       200:
         description: Return SPAD file - see TODO 
         body:
          application/json:
            schema: spad.json
            example: !include example1.json
            
</pre>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#schemas" id="schemas">Schemas</a></h1>
<p id="rfc.section.5.p.1">The JSON returned from MUST corespond to the following JSON schema.  </p>
<pre>
{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "type": "object",
  "title": "SPAD schema.",
  "properties": {
    "version": {
      "type": "integer",
      "title": "Version of schema used."
    },
    "transports": {
      "type": "array",
      "uniqueItems": false,
      "title": "Transport List",
      "description": "List of tranports used by the application.",
      "items": {
        "type": "object",
        "title": "Transport",
        "properties": {
          "ips": {
            "type": "array",
            "uniqueItems": false,
            "title": "IP addresses list",
            "items": {
              "type": "string",
              "title": "IPv4 or v6 address"
            }
          },
          "ports": {
            "type": "array",
            "title": "Port list",
            "items": {
              "type": "integer",
              "multipleOf": 1,
              "maximum": 10000,
              "minimum": 1,
              "title": "port",
              "description": "Destination ports used by the transport protocol."
            }
          },
          "dns": {
            "type": "array",
            "title": "DNS name list",
            "description": " ",
            "items": {
              "type": "string",
              "title": "DNS name",
              "description": "DNS name that will be used to connect to."
            }
          },
          "protocols": {
            "type": "array",
            "uniqueItems": true,
            "title": "Transport Protocol List",
            "description": "Protocols used.",
            "items": {
              "type": "string",
              "title": "protocol",
              "enum": [
                "udp",
                "tcp",
                "http",
                "tls",
                "https",
                "quic"
              ]
            }
          }
        },
        "required": [
          "ips",
          "ports"
        ]
      }
    }
  },
  "required": [
    "ver",
    "transports"
  ]
}
</pre>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#iana-consideration" id="iana-consideration">IANA Consideration</a></h1>
<p id="rfc.section.6.p.1">TODO - register well known URL usage </p>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a></h1>
<p id="rfc.section.7.p.1">TODO - explain importance of HTTPS </p>
<p id="rfc.section.7.p.2">Discuss merging with existing ACL </p>
<h1 id="rfc.section.8"><a href="#rfc.section.8">8.</a> <a href="#acknowledgments" id="acknowledgments">Acknowledgments</a></h1>
<p id="rfc.section.8.p.1">Thank you for the contributions from: Cullen Jennings </p>
<h1 id="rfc.references"><a href="#rfc.references">9.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">9.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">9.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="I-D.wright-json-schema">[I-D.wright-json-schema]</b>
      </td>
      <td class="top"><a>Wright, A.</a>, "<a href="http://tools.ietf.org/html/draft-wright-json-schema-00">JSON Schema: A Media Type for Describing JSON Documents</a>", Internet-Draft draft-wright-json-schema-00, October 2016.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.appendix.A"><a href="#rfc.appendix.A">Appendix A.</a> <a href="#contributing" id="contributing">Contributing</a></h1>
<p id="rfc.section.A.p.1">We welcome all contributions. Discussion happens in the <span>&lt;</span><a href="https://spadwg.slack.com/messages/general/">https://spadwg.slack.com/messages/general/</a><span>&gt;</span> room in slack and on GitHub issue threads. Changes are done via git pull requests. For PR merged into the master branch, we strive for rough consensus and we measure that view the reviews placed on the PR.  </p>
<p id="rfc.section.A.p.2">The Specification style is "less is more". If a reasonable developer who is fully up on modern web development practices could figure out how write an interoperable implementation after looking at some examples and code and asking a few questions, well that's good enough for us. If you can find it on Wikipedia, we don't need to explain it here.  </p>
<p id="rfc.section.A.p.3">Markdown is used for text. RAML and JSON Schema are used to describe the API. Examples are often used as normative specification. The build chain has the goal is to be simple and obvios with no black magic.  </p>
<h1 id="rfc.appendix.B"><a href="#rfc.appendix.B">Appendix B.</a> <a href="#published-versions" id="published-versions">Published Versions</a></h1>
<p id="rfc.section.B.p.1">The website at TBD provides an overview view of the specification that is focused on developers. However all the key information to implement the specification that is used to generate the website is also used to generate and internet draft that can be found at TBD that is slanted at specification developers. Periodically the information on the master is branched to versioned draft branch and published and an internet draft. A typical cadence for this is monthly so that it can receiver broader review. If the PRs that were merged to master represent WG rough consensus, it is expected that it the will move quickly through the standards process. When the work is at a good point to form a version of the API, it is progressed to an RFC and the text of the approved RFC is used to form a released version of the spec. The first version would be v1. The current working pre standard version is always referred to as v0.  The API includes the version in the URL so that developers can implement to a specific non changing specification. Future versions attempt, but do not guarantee, to be backwards comptable with the previos version.  </p>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Author's Address</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Cullen Jennings</span> 
	  <span class="n hidden">
		<span class="family-name">Jennings</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:fluffy@iii.ca">fluffy@iii.ca</a></span>

  </address>
</div>

</body>
</html>
